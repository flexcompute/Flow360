name: Build and Deploy New Documentation

on:
  push:
    branches:
      - develop

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout source code
      uses: actions/checkout@v2

    - name: Build HTML
      
      run: make html

    steps:
      - uses: actions/checkout@v2
      - uses: actions/setup-python@v4
        with:
          python-version: '3.9'
      - run: pip install sphinx
      - name: creates output
        working-directory: ../../docs
        run:  make html
      - name: Pushes to another repository
        uses: jinlin-flex/jinlinflex.github.io@main
        env:
          SSH_DEPLOY_KEY: ${{ secrets.API_TOKEN_GITHUB }}
        with:
          source-directory: './docs/_build/html/'
          destination-github-username: 'jinlin-flex'
          destination-repository-name: 'jinlinflex/github.io'
          user-email: lin@flexcompute.com
          target-branch: main