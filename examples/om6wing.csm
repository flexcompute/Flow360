# OM6 WING TUTORIAL STEP 1 | 3D Sketches of Airfoils
#============================================================================================
mark
skbeg 0.805900000   0.000000000  0.0000000000
spline 0.804129438   0.000231777  0.0000000000
spline 0.802038127   0.00050538   0.0000000000
spline 0.799568688   0.000828465  0.0000000000
spline 0.796652459   0.001209978  0.0000000000
spline 0.79320772    0.001660638  0.0000000000
spline 0.789138892   0.002192934  0.0000000000
spline 0.784330973   0.002821859  0.0000000000
spline 0.778649297   0.003565302  0.0000000000
spline 0.771932201   0.004444055  0.0000000000
spline 0.763988848   0.005483182  0.0000000000
spline 0.754592054   0.006710326  0.0000000000
spline 0.743469828   0.008150711  0.0000000000
spline 0.730298924   0.009828112  0.0000000000
spline 0.714691059   0.01168966   0.0000000000
spline 0.696181873   0.01377404   0.0000000000
spline 0.677546241   0.015782584  0.0000000000
spline 0.658809389   0.017717067  0.0000000000
spline 0.639969622   0.019585546  0.0000000000
spline 0.621026379   0.021397048  0.0000000000
spline 0.601979738   0.023158745  0.0000000000
spline 0.582826477   0.024875071  0.0000000000
spline 0.563568046   0.026546507  0.0000000000
spline 0.544202188   0.02816959   0.0000000000
spline 0.524728985   0.029736904  0.0000000000
spline 0.505146501   0.031237732  0.0000000000
spline 0.485454577   0.032658372  0.0000000000
spline 0.465652485   0.033983514  0.0000000000
spline 0.445738213   0.035196957  0.0000000000
spline 0.425710711   0.036282343  0.0000000000
spline 0.405570303   0.037224763  0.0000000000
spline 0.385316666   0.03801116   0.0000000000
spline 0.36494706    0.038630897  0.0000000000
spline 0.344459632   0.039072691  0.0000000000
spline 0.323856315   0.039344199  0.0000000000
spline 0.303134933   0.039432365  0.0000000000
spline 0.28229307    0.039342668  0.0000000000
spline 0.261331288   0.039078252  0.0000000000
spline 0.240247897   0.038642421  0.0000000000
spline 0.219041847   0.038037432  0.0000000000
spline 0.197712253   0.037261431  0.0000000000
spline 0.176258067   0.036306359  0.0000000000
spline 0.154678563   0.035154486  0.0000000000
spline 0.132971566   0.033774383  0.0000000000
spline 0.111130628   0.032116888  0.0000000000
spline 0.09266206    0.030456815  0.0000000000
spline 0.077072569   0.028830428  0.0000000000
spline 0.063937366   0.027269399  0.0000000000
spline 0.052891459   0.025799921  0.0000000000
spline 0.043619176   0.024441174  0.0000000000
spline 0.035850623   0.023202828  0.0000000000
spline 0.029355794   0.022026617  0.0000000000
spline 0.023935875   0.020811965  0.0000000000
spline 0.01942759    0.019503102  0.0000000000
spline 0.015683539   0.018096082  0.0000000000
spline 0.012585821   0.01661927   0.0000000000
spline 0.010031763   0.015113607  0.0000000000
spline 0.007931104   0.013618421  0.0000000000
spline 0.006214456   0.012165141  0.0000000000
spline 0.004815333   0.010775528  0.0000000000
spline 0.003683285   0.009462797  0.0000000000
spline 0.002774553   0.008233316  0.0000000000
spline 0.00205029    0.007088535  0.0000000000
spline 0.001479955   0.006026843  0.0000000000
spline 0.001037032   0.005044773  0.0000000000
spline 0.000697668   0.004137732  0.0000000000
spline 0.00044389    0.003300886  0.0000000000
spline 0.000260467   0.002529075  0.0000000000
spline 0.000134988   0.001817627  0.0000000000
spline 5.60906E-05   0.001161785  0.0000000000
spline 1.32974E-05   0.000557199  0.0000000000
spline 0.000000000   0.000000000  0.0000000000
skend
skbeg  0.000000000   0.000000000  0.000000000
spline 1.32974E-05  -0.000557199  0.000000000
spline 5.60906E-05  -0.001161785  0.000000000
spline 0.000134988  -0.001817627  0.000000000
spline 0.000260467  -0.002529075  0.000000000
spline 0.00044389   -0.003300886  0.000000000
spline 0.000697668  -0.004137732  0.000000000
spline 0.001037032  -0.005044773  0.000000000
spline 0.001479955  -0.006026843  0.000000000
spline 0.00205029   -0.007088535  0.000000000
spline 0.002774553  -0.008233316  0.000000000
spline 0.003683285  -0.009462797  0.000000000
spline 0.004815333  -0.010775528  0.000000000
spline 0.006214456  -0.012165141  0.000000000
spline 0.007931104  -0.013618421  0.000000000
spline 0.010031763  -0.015113607  0.000000000
spline 0.012585821  -0.01661927   0.000000000
spline 0.015683539  -0.018096082  0.000000000
spline 0.01942759   -0.019503102  0.000000000
spline 0.023935875  -0.020811965  0.000000000
spline 0.029355794  -0.022026617  0.000000000
spline 0.035850623  -0.023202828  0.000000000
spline 0.043619176  -0.024441174  0.000000000
spline 0.052891459  -0.025799921  0.000000000
spline 0.063937366  -0.027269399  0.000000000
spline 0.077072569  -0.028830428  0.000000000
spline 0.09266206   -0.030456815  0.000000000
spline 0.111130628  -0.032116888  0.000000000
spline 0.132971566  -0.033774383  0.000000000
spline 0.154678563  -0.035154486  0.000000000
spline 0.176258067  -0.036306359  0.000000000
spline 0.197712253  -0.037261431  0.000000000
spline 0.219041847  -0.038037432  0.000000000
spline 0.240247897  -0.038642421  0.000000000
spline 0.261331288  -0.039078252  0.000000000
spline 0.28229307   -0.039342668  0.000000000
spline 0.303134933  -0.039432365  0.000000000
spline 0.323856315  -0.039344199  0.000000000
spline 0.344459632  -0.039072691  0.000000000
spline 0.36494706   -0.038630897  0.000000000
spline 0.385316666  -0.03801116   0.000000000
spline 0.405570303  -0.037224763  0.000000000
spline 0.425710711  -0.036282343  0.000000000
spline 0.445738213  -0.035196957  0.000000000
spline 0.465652485  -0.033983514  0.000000000
spline 0.485454577  -0.032658372  0.000000000
spline 0.505146501  -0.031237732  0.000000000
spline 0.524728985  -0.029736904  0.000000000
spline 0.544202188  -0.02816959   0.000000000
spline 0.563568046  -0.026546507  0.000000000
spline 0.582826477  -0.024875071  0.000000000
spline 0.601979738  -0.023158745  0.000000000
spline 0.621026379  -0.021397048  0.000000000
spline 0.639969622  -0.019585546  0.000000000
spline 0.658809389  -0.017717067  0.000000000
spline 0.677546241  -0.015782584  0.000000000
spline 0.696181873  -0.01377404   0.000000000
spline 0.714691059  -0.01168966   0.000000000
spline 0.730298924  -0.009828112  0.000000000
spline 0.743469828  -0.008150711  0.000000000
spline 0.754592054  -0.006710326  0.000000000
spline 0.763988848  -0.005483182  0.000000000
spline 0.771932201  -0.004444055  0.000000000
spline 0.778649297  -0.003565302  0.000000000
spline 0.784330973  -0.002821859  0.000000000
spline 0.789138892  -0.002192934  0.000000000
spline 0.79320772   -0.001660638  0.000000000
spline 0.796652459  -0.001209978  0.000000000
spline 0.799568688  -0.000828465  0.000000000
spline 0.802038127  -0.00050538   0.000000000
spline 0.804129438  -0.000231777  0.000000000
skend
group
store rootAirfoil

mark
skbeg 0.45333164      0.000000000  0.000000000
spline 0.45233567     0.000130378  0.000000000
spline 0.451159275    0.000284284  0.000000000
spline 0.449770176    0.000466025  0.000000000
spline 0.44812975     0.000680632  0.000000000
spline 0.446192029    0.000934135  0.000000000
spline 0.443903249    0.001233561  0.000000000
spline 0.441198717    0.001587341  0.000000000
spline 0.438002684    0.002005539  0.000000000
spline 0.43422421     0.002499852  0.000000000
spline 0.429755947    0.003084378  0.000000000
spline 0.4244701      0.003774666  0.000000000
spline 0.41821367     0.004584906  0.000000000
spline 0.410804826    0.00552847   0.000000000
spline 0.402025152    0.006575621  0.000000000
spline 0.391613439    0.007748118  0.000000000
spline 0.381130598    0.008877956  0.000000000
spline 0.370590818    0.009966133  0.000000000
spline 0.359993149    0.011017183  0.000000000
spline 0.349337271    0.012036182  0.000000000
spline 0.338623231    0.013027165  0.000000000
spline 0.327849215    0.013992625  0.000000000
spline 0.31701604     0.014932835  0.000000000
spline 0.306122435    0.015845845  0.000000000
spline 0.295168447    0.016727484  0.000000000
spline 0.284152987    0.017571724  0.000000000
spline 0.273075964    0.018370857  0.000000000
spline 0.261936971    0.01911627   0.000000000
spline 0.250734874    0.019798851  0.000000000
spline 0.239469084    0.020409398  0.000000000
spline 0.228139782    0.020939524  0.000000000
spline 0.216746788    0.021381885  0.000000000
spline 0.205288559    0.021730497  0.000000000
spline 0.193764052    0.021979014  0.000000000
spline 0.182174357    0.022131741  0.000000000
spline 0.170518248    0.022181336  0.000000000
spline 0.158794367    0.02213088   0.000000000
spline 0.14700303     0.021982142  0.000000000
spline 0.135143285    0.02173698   0.000000000
spline 0.123214542    0.021396664  0.000000000
spline 0.111216305    0.020960151  0.000000000
spline 0.099147982    0.020422908  0.000000000
spline 0.087009166    0.019774961  0.000000000
spline 0.074798633    0.01899863   0.000000000
spline 0.062512756    0.018066263  0.000000000
spline 0.052123891    0.017132445  0.000000000
spline 0.043354553    0.016217577  0.000000000
spline 0.035965791    0.015339473  0.000000000
spline 0.029752292    0.014512868  0.000000000
spline 0.024536484    0.013748551  0.000000000
spline 0.020166549    0.013051962  0.000000000
spline 0.016513104    0.012390324  0.000000000
spline 0.013464312    0.011707063  0.000000000
spline 0.01092833     0.010970807  0.000000000
spline 0.008822242    0.010179335  0.000000000
spline 0.007079726    0.009348605  0.000000000
spline 0.005643027    0.008501646  0.000000000
spline 0.004461373    0.007660579  0.000000000
spline 0.003495731    0.006843086  0.000000000
spline 0.002708702    0.006061407  0.000000000
spline 0.002071907    0.005322975  0.000000000
spline 0.00156073     0.004631372  0.000000000
spline 0.001153321    0.003987414  0.000000000
spline 0.000832498    0.003390195  0.000000000
spline 0.000583347    0.002837765  0.000000000
spline 0.000392449    0.002327541  0.000000000
spline 0.000249695    0.001856801  0.000000000
spline 0.000146517    0.001422645  0.000000000
spline 7.5933E-05     0.001022444  0.000000000
spline 3.15519E-05    0.000653523  0.000000000
spline 7.47997E-06    0.000313433  0.000000000
spline 0.000000000    0.000000000  0.000000000
skend
skbeg 0.00000000      0.000000000  0.000000000
spline 7.47997E-06   -0.000313433  0.000000000
spline 3.15519E-05   -0.000653523  0.000000000
spline 7.5933E-05    -0.001022444  0.000000000
spline 0.000146517   -0.001422645  0.000000000
spline 0.000249695   -0.001856801  0.000000000
spline 0.000392449   -0.002327541  0.000000000
spline 0.000583347   -0.002837765  0.000000000
spline 0.000832498   -0.003390195  0.000000000
spline 0.001153321   -0.003987414  0.000000000
spline 0.00156073    -0.004631372  0.000000000
spline 0.002071907   -0.005322975  0.000000000
spline 0.002708702   -0.006061407  0.000000000
spline 0.003495731   -0.006843086  0.000000000
spline 0.004461373   -0.007660579  0.000000000
spline 0.005643027   -0.008501646  0.000000000
spline 0.007079726   -0.009348605  0.000000000
spline 0.008822242   -0.010179335  0.000000000
spline 0.01092833    -0.010970807  0.000000000
spline 0.013464312   -0.011707063  0.000000000
spline 0.016513104   -0.012390324  0.000000000
spline 0.020166549   -0.013051962  0.000000000
spline 0.024536484   -0.013748551  0.000000000
spline 0.029752292   -0.014512868  0.000000000
spline 0.035965791   -0.015339473  0.000000000
spline 0.043354553   -0.016217577  0.000000000
spline 0.052123891   -0.017132445  0.000000000
spline 0.062512756   -0.018066263  0.000000000
spline 0.074798633   -0.01899863   0.000000000
spline 0.087009166   -0.019774961  0.000000000
spline 0.099147982   -0.020422908  0.000000000
spline 0.111216305   -0.020960151  0.000000000
spline 0.123214542   -0.021396664  0.000000000
spline 0.135143285   -0.02173698   0.000000000
spline 0.14700303    -0.021982142  0.000000000
spline 0.158794367   -0.02213088   0.000000000
spline 0.170518248   -0.022181336  0.000000000
spline 0.182174357   -0.022131741  0.000000000
spline 0.193764052   -0.021979014  0.000000000
spline 0.205288559   -0.021730497  0.000000000
spline 0.216746788   -0.021381885  0.000000000
spline 0.228139782   -0.020939524  0.000000000
spline 0.239469084   -0.020409398  0.000000000
spline 0.250734874   -0.019798851  0.000000000
spline 0.261936971   -0.01911627   0.000000000
spline 0.273075964   -0.018370857  0.000000000
spline 0.284152987   -0.017571724  0.000000000
spline 0.295168447   -0.016727484  0.000000000
spline 0.306122435   -0.015845845  0.000000000
spline 0.31701604    -0.014932835  0.000000000
spline 0.327849215   -0.013992625  0.000000000
spline 0.338623231   -0.013027165  0.000000000
spline 0.349337271   -0.012036182  0.000000000
spline 0.359993149   -0.011017183  0.000000000
spline 0.370590818   -0.009966133  0.000000000
spline 0.381130598   -0.008877956  0.000000000
spline 0.391613439   -0.007748118  0.000000000
spline 0.402025152   -0.006575621  0.000000000
spline 0.410804826   -0.00552847   0.000000000
spline 0.41821367    -0.004584906  0.000000000
spline 0.4244701     -0.003774666  0.000000000
spline 0.429755947   -0.003084378  0.000000000
spline 0.43422421    -0.002499852  0.000000000
spline 0.438002684   -0.002005539  0.000000000
spline 0.441198717   -0.001587341  0.000000000
spline 0.443903249   -0.001233561  0.000000000
spline 0.446192029   -0.000934135  0.000000000
spline 0.44812975    -0.000680632  0.000000000
spline 0.449770176   -0.000466025  0.000000000
spline 0.451159275   -0.000284284  0.000000000
spline 0.45233567    -0.000130378  0.000000000
skend
group
store tipAirfoil

# OM6 WING TUTORIAL STEP 2 | Wing Planform
#============================================================================================

# SWEPT WING OM6 PARAMETERS
#--------------------------------------------------------------------------------------------
DESPMTR span 1.1963
CONPMTR LEsweep 30 

# TIP FACE
#--------------------------------------------------------------------------------------------
restore tipAirfoil
join
rotatex 90 0 0
translate span/tand(90-LEsweep) -span 0

# COLLECTING NODE COORDINATES AT TIP FACE TO ADD ATTRIBUTE AFTER BLEND
#--------------------------------------------------------------------------------------------
dimension tipLeadingPoint  1 3
dimension tipTrailingPointUp 1 3
dimension tipTrailingPointLow 1 3

set xmin @xmax
set zmin @zmax
set zmax @zmin

set numNodes @nnode
patbeg inode numNodes
    evaluate node @ibody inode
    IFTHEN @edata[1] LT xmin
        set xmin @edata[1]
        set tipLeadingPoint "xmin;@edata[2];@edata[3];"
        set leadingNodeID inode
    ENDIF
patend

patbeg inode numNodes
    IFTHEN inode NE leadingNodeID
        evaluate node @ibody inode
        IFTHEN @edata[3] GT zmax
            set zmax @edata[3]
            set tipTrailingPointUp "@edata[1];@edata[2];zmax;"
        ENDIF

        IFTHEN @edata[3] LT zmin
            set zmin @edata[3]
            set tipTrailingPointLow "@edata[1];@edata[2];zmin;"
        ENDIF
    ENDIF
patend

# TIP AIRFOIL --> TIP FACE
combine
store tipFace

# ROOT FACE
#--------------------------------------------------------------------------------------------
restore rootAirfoil
join
rotatex 90 0 0

# COLLECTING NODE COORDINATES AT ROOT FACE TO ADD ATTRIBUTE AFTER BLEND
#--------------------------------------------------------------------------------------------
# defining arrays with one row and three columns
dimension rootLeadingPoint  1 3
dimension rootTrailingPointUp 1 3
dimension rootTrailingPointLow 1 3

# initializing xmin, zmin, zmax with their opposite extremes
set xmin @xmax
set zmin @zmax
set zmax @zmin

set numNodes @nnode
patbeg inode numNodes
    evaluate node @ibody inode
    IFTHEN @edata[1] LT xmin
        set xmin @edata[1]
        set rootLeadingPoint "xmin;@edata[2];@edata[3];"
        set leadingNodeID inode
    ENDIF
patend

patbeg inode numNodes
    IFTHEN inode NE leadingNodeID
        evaluate node @ibody inode
        IFTHEN @edata[3] GT zmax
            set zmax @edata[3]
            set rootTrailingPointUp  "@edata[1];@edata[2];zmax;"
        ENDIF

        IFTHEN @edata[3] LT zmin
            set zmin @edata[3]
            set rootTrailingPointLow "@edata[1];@edata[2];zmin;"
        ENDIF
    ENDIF
patend

# ROOT AIRFOIL --> ROOT FACE
combine
store rootFace

# OM6 WING TUTORIAL STEP 3 | Wing Solid Model
#============================================================================================
mark
restore tipFace
restore rootFace
blend "-1;1.1"

# OM6 WING TUTORIAL STEP 4 | Adding Attributes | Method 1: Using Edge Attribute UDPRIM
#=============================================================================================

#ADDING EDGE ATTRIBUTES
#--------------------------------------------------------------------------------------------

# METHOD 1: USING COORDINATES OF NODES
udparg edgeAttr attrname $edgeName  attrstr $wingLeadingEdge
udprim edgeAttr xyzs "rootLeadingPoint[1];rootLeadingPoint[2];rootLeadingPoint[3];tipLeadingPoint[1];tipLeadingPoint[2];tipLeadingPoint[3];"
udparg edgeAttr attrname $edgeName  attrstr $wingTrailingEdge
udprim edgeAttr xyzs "rootTrailingPointUp[1];rootTrailingPointUp[2];rootTrailingPointUp[3];tipTrailingPointUp[1];tipTrailingPointUp[2];tipTrailingPointUp[3];"
udparg edgeAttr attrname $edgeName  attrstr $wingTrailingEdge
udprim edgeAttr xyzs "rootTrailingPointLow[1];rootTrailingPointLow[2];rootTrailingPointLow[3];tipTrailingPointLow[1];tipTrailingPointLow[2];tipTrailingPointLow[3];"


# OM6 WING TUTORIAL STEP 4 | Adding Attributes | Method 2: Using Bounding Box
#=============================================================================================

# METHOD 2: USING BOUNDING BOX
select edge @xmin @xmax -0.01 0.01 @zmin @zmax
attribute edgeName $rootAirfoilEdge

# OM6 WING TUTORIAL STEP 4 | Adding Attributes | Method 3: Using Bounding Box
#=============================================================================================

# METHOD 3: USING EDGE ID
select edge 2
attribute edgeName $tipAirfoilEdge

select edge 5
attribute edgeName $tipAirfoilEdge


# OM6 WING TUTORIAL STEP 5 | Adding Face and Group Attributes 
#=============================================================================================

store wingModel

#ADDING FACE AND GROUP ATTRIBUTE
#--------------------------------------------------------------------------------------------
restore wingModel
attribute faceName $wing
attribute groupName $wing
scale 1/0.8059 0 0 0

END
